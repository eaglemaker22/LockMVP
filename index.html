<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loan Officer Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style>
    @keyframes flashHighlight {
      0% { background-color: #facc15; }
      100% { background-color: inherit; }
    }
    body {
      background-color: #0f172a;
      color: white;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .card {
      background: linear-gradient(135deg, #1e3a8a, #9333ea);
      border-radius: 0.75rem;
      padding: 1.25rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.5);
      transition: transform 0.3s ease-in-out;
    }
    .card:hover {
      transform: scale(1.02);
    }
    .flash {
      animation: flashHighlight 1s ease-in-out;
    }
    .section-title {
      font-size: 1.5rem;
      font-weight: bold;
      margin-top: 2rem;
      margin-bottom: 1rem;
      color: #38bdf8;
      border-bottom: 2px solid #334155;
    }
  </style>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBRKEG-8z29rtc9WuRUUAX1vT8tpFYEAd0",
      authDomain: "peaceful-guide-460403-v5.firebaseapp.com",
      projectId: "peaceful-guide-460403-v5",
      storageBucket: "peaceful-guide-460403-v5.appspot.com",
      messagingSenderId: "818426236765",
      appId: "1:818426236765:web:b1686a788077530af862b4",
      measurementId: "G-JH3EF76TP5"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const updateText = (id, val) => {
      const el = document.getElementById(id);
      if (!el || val === undefined) return;
      if (el.textContent !== String(val)) {
        el.textContent = val;
        el.classList.add("flash");
        setTimeout(() => el.classList.remove("flash"), 1000);
      }
    };

    const loadDoc = (collection, docId, fields) => {
      db.collection(collection).doc(docId).get().then(snapshot => {
        if (!snapshot.exists) return;
        const data = snapshot.data();
        fields.forEach(f => updateText(f.id, data[f.key]));
      });
    };

    window.addEventListener("DOMContentLoaded", () => {
      [
        { collection: "market_data", doc: "mbs_products", fields: [
          { id: "umbs55", key: "UMBS_5_5_Current" },
          { id: "umbs60", key: "UMBS_6_0_Current" },
          { id: "gnma55", key: "GNMA_5_5_Current" },
          { id: "gnma60", key: "GNMA_6_0_Current" }
        ]},
        { collection: "market_data", doc: "shadow_bonds", fields: [
          { id: "shadumbs55", key: "UMBS_5_5_Shadow" },
          { id: "shadumbs60", key: "UMBS_6_0_Shadow" },
          { id: "shadognma55", key: "GNMA_5_5_Shadow" },
          { id: "shadognma60", key: "GNMA_6_0_Shadow" }
        ]},
        { collection: "market_data", doc: "us10y_current", fields: [
          { id: "us10y", key: "Current" }
        ]},
        { collection: "bonds_for_umbs", doc: "0438NXPZ4R9vSz6AAibM", fields: [
          { id: "us30y", key: "US30Y" },
          { id: "mbb", key: "MBB" },
          { id: "tlt", key: "TLT" },
          { id: "tn1", key: "TN1" },
          { id: "zn1", key: "ZN1" }
        ]}
      ].forEach(cfg => loadDoc(cfg.collection, cfg.doc, cfg.fields));
    });
  </script>
</head>
<body>
  <div class="p-6">
    <h1 class="text-3xl font-bold text-center text-yellow-300 mb-10">Loan Officer Financial Dashboard</h1>

    <h2 class="section-title">Live Bond Prices</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="card"><h2>UMBS 5.5</h2><p>Current: <span id="umbs55">--</span></p></div>
      <div class="card"><h2>UMBS 6.0</h2><p>Current: <span id="umbs60">--</span></p></div>
      <div class="card"><h2>GNMA 5.5</h2><p>Current: <span id="gnma55">--</span></p></div>
      <div class="card"><h2>GNMA 6.0</h2><p>Current: <span id="gnma60">--</span></p></div>
      <div class="card"><h2>Shadow UMBS 5.5</h2><p>Current: <span id="shadumbs55">--</span></p></div>
      <div class="card"><h2>Shadow UMBS 6.0</h2><p>Current: <span id="shadumbs60">--</span></p></div>
      <div class="card"><h2>Shadow GNMA 5.5</h2><p>Current: <span id="shadognma55">--</span></p></div>
      <div class="card"><h2>Shadow GNMA 6.0</h2><p>Current: <span id="shadognma60">--</span></p></div>
      <div class="card"><h2>US 10Y Treasury</h2><p>Current: <span id="us10y">--</span></p></div>
      <div class="card"><h2>US 30Y Treasury</h2><p>Current: <span id="us30y">--</span></p></div>
      <div class="card"><h2>MBB</h2><p>Price: <span id="mbb">--</span></p></div>
      <div class="card"><h2>TLT</h2><p>Price: <span id="tlt">--</span></p></div>
      <div class="card"><h2>TN1 (10Y Futures)</h2><p>Price: <span id="tn1">--</span></p></div>
      <div class="card"><h2>ZN1 (10Y Note)</h2><p>Price: <span id="zn1">--</span></p></div>
    </div>
  </div>
</body>
</html>
